
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Spectra and Eddy Lifetime Function Learning &#8212; DRDMannTurb 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'calibration';</script>
    <script src="_static/require.min.js?v=8a87acde"></script>
    <script src="_static/custom.js?v=9aa989ff"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Loss Function Evaluation" href="losses.html" />
    <link rel="prev" title="Data Types and Eddy Lifetime Functions" href="datatypes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">DRDMannTurb 0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting-started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="forward_api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="internal_api.html">
                        Internal API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="getting-started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="forward_api.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="internal_api.html">
                        Internal API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="fitting.html">Spectra Fitting with DRD Calibration</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="data_types_and_classes.html">Data Types and Data Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="dataclasses.html">Dataclass Primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="datatypes.html">Data Types and Eddy Lifetime Functions</a></li>
</ul>
</li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Spectra and Eddy Lifetime Function Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="losses.html">Loss Function Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpolation.html">Spectra Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tb_loss.html">Visualizing Training</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="windgeneration.html">Fluctuation Field Generation</a></li>

</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="forward_api.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="fitting.html" class="nav-link">Spectra Fitting with DRD Calibration</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Spectra and...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="spectra-and-eddy-lifetime-function-learning">
<h1>Spectra and Eddy Lifetime Function Learning<a class="headerlink" href="#spectra-and-eddy-lifetime-function-learning" title="Link to this heading">#</a></h1>
<p>Please refer to <a class="reference internal" href="uml_drd.html"><span class="doc">this UML diagram</span></a> to see how data classes are composed to inform the <a class="reference internal" href="#drdmannturb.CalibrationProblem" title="drdmannturb.CalibrationProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">CalibrationProblem</span></code></a> classes.</p>
<p>Uses of this class require the <a class="reference internal" href="#drdmannturb.OnePointSpectraDataGenerator" title="drdmannturb.OnePointSpectraDataGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator</span></code></a>, please refer to that documentation for specifics about data needed for spectra fitting.</p>
<section id="calibrationproblem">
<h2>CalibrationProblem<a class="headerlink" href="#calibrationproblem" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drdmannturb.</span></span><span class="sig-name descname"><span class="pre">CalibrationProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataclasses.html#drdmannturb.NNParameters" title="drdmannturb.parameters.NNParameters"><span class="pre">NNParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataclasses.html#drdmannturb.ProblemParameters" title="drdmannturb.parameters.ProblemParameters"><span class="pre">ProblemParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataclasses.html#drdmannturb.LossParameters" title="drdmannturb.parameters.LossParameters"><span class="pre">LossParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataclasses.html#drdmannturb.PhysicalParameters" title="drdmannturb.parameters.PhysicalParameters"><span class="pre">PhysicalParameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PosixPath('/home/ai/Documents/wind/DRDMannTurb/examples/results')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem" title="Link to this definition">#</a></dt>
<dd><p id="calibration-problem-reference">Class which manages the spectra fitting and eddy lifetime function learning based on the deep rapid distortion model developed
in <a class="reference external" href="https://arxiv.org/pdf/2107.11046.pdf">Keith, Khristenko, Wohlmuth (2021)</a>.</p>
<p>This class manages the operator regression task which characterizes the best fitting candidate
in a family of nonlocal covariance kernels that are parametrized by a neural network.</p>
<p>This class can also be used independently of neural networks via the <code class="docutils literal notranslate"><span class="pre">EddyLifetimeType</span></code> used for classical spectra fitting tasks, for instance, using
the <code class="docutils literal notranslate"><span class="pre">EddyLifetimeType.MANN</span></code> results in a fit that completely relies on the Mann eddy lifetime function. If a neural network model is used, Torch’s <code class="docutils literal notranslate"><span class="pre">LBFGS</span></code> optimizer is used with cosine annealing for learning rate scheduling. Parameters for these components of the training process are set in <code class="docutils literal notranslate"><span class="pre">LossParameters</span></code> and <code class="docutils literal notranslate"><span class="pre">ProblemParameters</span></code> during initialization.</p>
<p>After instantiating <code class="docutils literal notranslate"><span class="pre">CalibrationProblem</span></code>, wherein the problem and eddy lifetime function substitution
type are indicated, the user will need to generate the OPS data using <code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator</span></code>,
after which the model can be fit with <code class="docutils literal notranslate"><span class="pre">CalibrationProblem.calibrate</span></code>.</p>
<p>After training, this class can be used in conjunction with the fluctuation generation utilities in this package to generate
realistic turbulence fields based on the learned spectra and eddy lifetimes.</p>
<p>Constructor for <code class="docutils literal notranslate"><span class="pre">CalibrationProblem</span></code> class. As depicted in the UML diagram, this requires of 4 dataclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str,</span></code>) – One of the strings <code class="docutils literal notranslate"><span class="pre">&quot;cpu&quot;,</span> <span class="pre">&quot;cuda&quot;,</span> <span class="pre">&quot;mps&quot;</span></code> indicating the torch device to use</p></li>
<li><p><strong>nn_params</strong> (<a class="reference internal" href="dataclasses.html#drdmannturb.NNParameters" title="drdmannturb.NNParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">NNParameters</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">NNParameters</span></code> (for Neural Network) dataclass instance, which defines values of interest
eg. size and depth. By default, calls constructor using default values.</p></li>
<li><p><strong>prob_params</strong> (<a class="reference internal" href="dataclasses.html#drdmannturb.ProblemParameters" title="drdmannturb.ProblemParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProblemParameters</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">ProblemParameters</span></code> dataclass instance, which is used to determine the conditional branching
and computations required, among other things. By default, calls constructor using default values</p></li>
<li><p><strong>loss_params</strong> (<a class="reference internal" href="dataclasses.html#drdmannturb.LossParameters" title="drdmannturb.LossParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">LossParameters</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">LossParameters</span></code> dataclass instance, which defines the loss function terms and related coefficients.
By default, calls constructor using the default values.</p></li>
<li><p><strong>phys_params</strong> (<a class="reference internal" href="dataclasses.html#drdmannturb.PhysicalParameters" title="drdmannturb.PhysicalParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalParameters</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">PhysicalParameters</span></code> dataclass instance, which defines the physical constants governing the
problem setting; note that the <code class="docutils literal notranslate"><span class="pre">PhysicalParameters</span></code> constructor requires three positional
arguments.</p></li>
<li><p><strong>output_directory</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str]</span></code>, <em>optional</em>) – The directory to write output to; by default <code class="docutils literal notranslate"><span class="pre">&quot;./results&quot;</span></code></p></li>
<li><p><strong>logging_directory</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data:</span> <span class="pre">tuple[~collections.abc.Iterable[float],</span> <span class="pre">~torch.Tensor],</span> <span class="pre">tb_comment:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'',</span> <span class="pre">optimizer_class:</span> <span class="pre">~torch.optim.optimizer.Optimizer</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.optim.lbfgs.LBFGS'&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.calibrate" title="Link to this definition">#</a></dt>
<dd><p>Calibration method, which handles the main training loop and some
data pre-processing. Currently the only supported optimizer is Torch’s <code class="docutils literal notranslate"><span class="pre">LBFGS</span></code>
and the learning rate scheduler uses cosine annealing. Parameters for these
components of the training process are set in <code class="docutils literal notranslate"><span class="pre">LossParameters</span></code> and <code class="docutils literal notranslate"><span class="pre">ProblemParameters</span></code>
during initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[Iterable[float]</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor]</span></code>) – Tuple of data points and values, respectively, to be used in calibration.</p></li>
<li><p><strong>tb_comment</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Filename comment used by tensorboard; useful for distinguishing between architectures and hyperparameters. Refer to tensorboard documentation for examples of use. By default, the empty string, which results in default tensorboard filenames.</p></li>
<li><p><strong>optimizer_class</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>, <em>optional</em>) – Choice of Torch optimizer, by default torch.optim.LBFGS</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> – Problem parameters as a Numpy array</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – Thrown in the case that the current loss is not finite.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.eval" title="Link to this definition">#</a></dt>
<dd><p>Calls the calibrated model on <span class="math notranslate nohighlight">\(k_1\)</span>. This can be done after training or after loading trained model parameters from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Tensor of <span class="math notranslate nohighlight">\(k_1\)</span> data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> – Evaluation of the model represented in a Numpy array (CPU bound)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.eval_grad">
<span class="sig-name descname"><span class="pre">eval_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.eval_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.eval_grad" title="Link to this definition">#</a></dt>
<dd><p>Evaluates gradient of <span class="math notranslate nohighlight">\(k_1\)</span> via Autograd</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Tensor of :math:<span class="math notranslate nohighlight">\(k_1\)</span> data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> – Numpy array of resultant gradient (CPU bound)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.eval_trainable_norm">
<span class="sig-name descname"><span class="pre">eval_trainable_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'fro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.eval_trainable_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.eval_trainable_norm" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Evaluates the magnitude (or other norm) of the</dt><dd><p>trainable parameters in the model.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">EddyLifetimeType</span></code> must be set to one of <code class="docutils literal notranslate"><span class="pre">TAUNET</span></code> or <code class="docutils literal notranslate"><span class="pre">CUSTOMMLP</span></code>, which involve
a network surrogate for the eddy lifetime.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ord</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Union[float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str]]</span></code>) – The order of the norm approximation, follows <code class="docutils literal notranslate"><span class="pre">torch.norm</span></code> conventions.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the OPS was not initialized to one of <code class="docutils literal notranslate"><span class="pre">TAUNET</span></code>, <code class="docutils literal notranslate"><span class="pre">CUSTOMMLP</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.format_input">
<span class="sig-name descname"><span class="pre">format_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.format_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.format_input" title="Link to this definition">#</a></dt>
<dd><p>Wrapper around clone and cast <span class="math notranslate nohighlight">\(k_1\)</span> to <code class="docutils literal notranslate"><span class="pre">torch.float64</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Tensor of <span class="math notranslate nohighlight">\(k_1\)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – Copy of <cite>:math:`k_1</cite> casted to doubles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.format_output">
<span class="sig-name descname"><span class="pre">format_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.format_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.format_output" title="Link to this definition">#</a></dt>
<dd><p>Wrapper around torch’s <code class="docutils literal notranslate"><span class="pre">out.cpu().numpy()</span></code>. Returns a CPU tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Tensor to be brought to CPU and converted to an <cite>np.ndarray</cite></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> – Numpy array of the input tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.init_device">
<span class="sig-name descname"><span class="pre">init_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.init_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.init_device" title="Link to this definition">#</a></dt>
<dd><p>Initializes the device (CPU or GPU) on which computation is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string following PyTorch conventions – “cuda” or “cpu”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.initialize_parameters_with_noise">
<span class="sig-name descname"><span class="pre">initialize_parameters_with_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.initialize_parameters_with_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.initialize_parameters_with_noise" title="Link to this definition">#</a></dt>
<dd><p>Simple routine to introduce additive white noise to the OPS parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.log_dimensional_scales">
<span class="sig-name descname"><span class="pre">log_dimensional_scales</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.log_dimensional_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.log_dimensional_scales" title="Link to this definition">#</a></dt>
<dd><p>Sets the quantities for non-dimensionalization in log-space.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first 3 parameters of self.parameters() are exactly</p>
<ol class="arabic simple">
<li><p>LengthScale</p></li>
<li><p>TimeScale</p></li>
<li><p>Spectrum Amplitude</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.num_trainable_params">
<span class="sig-name descname"><span class="pre">num_trainable_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.num_trainable_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.num_trainable_params" title="Link to this definition">#</a></dt>
<dd><dl>
<dt>Computes the number of trainable network parameters</dt><dd><p>in the underlying model.</p>
<p>The EddyLifetimeType must be set to one of the following, which involve
a network surrogate for the eddy lifetime:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TAUNET</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CUSTOMMLP</span></code></p></li>
</ol>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> – The number of trainable network parameters in the underlying model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the OPS was not initialized to one of TAUNET, CUSTOMMLP</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#drdmannturb.CalibrationProblem.parameters" title="Link to this definition">#</a></dt>
<dd><p>Returns all parameters of the One Point Spectra surrogate model as a single vector.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first 3 parameters of self.parameters() are exactly
#.  LengthScale</p>
<ol class="arabic simple">
<li><p>TimeScale</p></li>
<li><p>Spectrum Amplitude</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> – Single vector containing all model parameters on the CPU, which can be loaded into an object with the same architecture with the
parameters setter method. This automatically offloads any model parameters that were on the GPU, if any.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.plot" title="Link to this definition">#</a></dt>
<dd><p>Plotting method which visualizes the spectra fit as well as the learned eddy lifetime
function, if <code class="docutils literal notranslate"><span class="pre">plot_tau=True</span></code>. By default, this operates on the data used in the fitting,
but an alternative <span class="math notranslate nohighlight">\(k_1\)</span> domain can be provided and the trained model can be re-evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[Iterable[float]</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor]</span></code>, <em>optional</em>) – Tuple of data points and corresponding values, by default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><strong>model_vals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, <em>optional</em>) – Evaluation of the OPS on the data, by default None in which case
<code class="docutils literal notranslate"><span class="pre">Data</span></code> must provided (since the function will call OPS on the provided
<code class="docutils literal notranslate"><span class="pre">Data</span></code>)</p></li>
<li><p><strong>plot_tau</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – Indicates whether to plot the learned eddy lifetime function or not,
by default <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><strong>save</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – Whether to save the resulting figure, by default <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><strong>save_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Union[Path</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str]]</span></code>, <em>optional</em>) – Directory to save to, which is created safely if not already present. By default,
this is the current working directory.</p></li>
<li><p><strong>save_filename</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <em>optional</em>) – Filename to save the final figure to, by default <code class="docutils literal notranslate"><span class="pre">drdmannturb_final_spectra_fit.png</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Must either provide <code class="docutils literal notranslate"><span class="pre">k1space</span></code> or re-use what was used for model calibration;
    thrown in the case neither is specified.</p></li>
<li><p><strong>ValueError</strong> – Must either provide data points or re-use what was used for model calibration;
    thrown in the case neither is specified.</p></li>
<li><p><strong>ValueError</strong> – Thrown in the case that <code class="docutils literal notranslate"><span class="pre">save</span></code> is true but neither the <code class="docutils literal notranslate"><span class="pre">save_dir</span></code> or <code class="docutils literal notranslate"><span class="pre">output_directory</span></code>
    are provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.plot_losses">
<span class="sig-name descname"><span class="pre">plot_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.plot_losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.plot_losses" title="Link to this definition">#</a></dt>
<dd><p>A wrapper method around the <code class="docutils literal notranslate"><span class="pre">plot_loss_logs</span></code> helper, which plots out the loss
function terms, multiplied by their associated hyperparameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>run_number</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of the run in the logging directory to plot out. This is 0-indexed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.CalibrationProblem.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/calibration.html#CalibrationProblem.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.CalibrationProblem.save_model" title="Link to this definition">#</a></dt>
<dd><p>Saves model with current weights, model configuration, and training histories to file.
The written filename is of the form <code class="docutils literal notranslate"><span class="pre">save_dir/&lt;EddyLifetimeType&gt;_&lt;DataType&gt;.pkl</span></code></p>
<p>This routine stores</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NNParameters</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ProblemParameters</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PhysicalParameters</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LossParameters</span></code></p></li>
<li><p>Optimized Parameters (<code class="docutils literal notranslate"><span class="pre">self.parameters</span></code> field)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <em>optional</em>) – Directory to save to, by default None; defaults to provided output_dir field for object.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – No output_directory provided during object initialization and no save_dir provided for this method call.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="onepointspectradatagenerator">
<h2>OnePointSpectraDataGenerator<a class="headerlink" href="#onepointspectradatagenerator" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectraDataGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drdmannturb.</span></span><span class="sig-name descname"><span class="pre">OnePointSpectraDataGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datatypes.html#drdmannturb.DataType" title="drdmannturb.enums.DataType"><span class="pre">DataType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">DataType.KAIMAL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k1_data_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/data_generator.html#OnePointSpectraDataGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectraDataGenerator" title="Link to this definition">#</a></dt>
<dd><p>The one point spectra data generator, which evaluates one of a few spectral tensor models across a grid of <span class="math notranslate nohighlight">\(k_1\)</span> wavevector points which is used as data in the fitting done in the <a class="reference internal" href="#drdmannturb.OnePointSpectra" title="drdmannturb.OnePointSpectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">OnePointSpectra</span></code></a> class.</p>
<p>The type of spectral tensor is determined by the <a class="reference internal" href="datatypes.html#drdmannturb.DataType" title="drdmannturb.DataType"><code class="xref py py-enum docutils literal notranslate"><span class="pre">DataType</span></code></a> argument, which determines one of the following models:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataType.KAIMAL</span></code>, which is the Kaimal spectra.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataType.VK</span></code>, which is the von Karman spectra model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataType.CUSTOM</span></code>, usually used for data that is processed from real-world data. The spectra values are to be provided as the <code class="docutils literal notranslate"><span class="pre">spectra_values</span></code> field, or else to be loaded from a provided <code class="docutils literal notranslate"><span class="pre">spectra_file</span></code>. The result is that the provided data are matched on the wavevector domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code>, which generates a filtered version of provided spectra data. The filtering is based on differential evolution to perform a non-linear fit onto functions of the following form:</p></li>
</ol>
<div class="math notranslate nohighlight">
\begin{align}
    &amp; \frac{k_1 F_{11}\left(k_1 z\right)}{u_*^2}=J_1(f):=\frac{a_1 f}{(1+b_1 f)^{c_1}} \\
    &amp; \frac{k_1 F_{22}\left(k_1 z\right)}{u_*^2}=J_2(f):=\frac{a_2 f}{(1+b_2 f)^{c_2}} \\
    &amp; \frac{k_1 F_{33}\left(k_1 z\right)}{u_*^2}=J_3(f):=\frac{a_3 f}{1+ b_3 f^{ c_3}} \\
    &amp; -\frac{k_1 F_{13}\left(k_1 z\right)}{u_*^2}=J_4(f):=\frac{a_4 f}{(1+ b_4 f)^{c_4}},
\end{align}</div><p>with <span class="math notranslate nohighlight">\(F_{12}=F_{23}=0\)</span>. Here, <span class="math notranslate nohighlight">\(f = (2\pi)^{-1} k_1 z\)</span>. In the above, the <span class="math notranslate nohighlight">\(a_i, b_i, c_i\)</span> are free parameters which are optimized by differential evolution. The result is a spectra model that is similar in form to the Kaimal spectra and which filters/smooths the spectra data from the real world and eases fitting by DRD models. This option is highly suggested in cases where spectra data have large deviations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The one-point spectra for <span class="math notranslate nohighlight">\(F_{13}\)</span> are NOT to be pre-multiplied with a negative, this data generator automatically performs this step both when using <code class="docutils literal notranslate"><span class="pre">DataType.CUSTOM</span></code> and <code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable[Tuple[torch.tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]]</span></code>, <em>optional</em>) – Observed spectra data points at each of the <span class="math notranslate nohighlight">\(k_1\)</span> coordinates, paired with the associated reference height (typically kept at 1, but may depend on applications).</p></li>
<li><p><strong>data_type</strong> (<a class="reference internal" href="datatypes.html#drdmannturb.DataType" title="drdmannturb.DataType"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataType</span></code></a>, <em>optional</em>) – Indicates the data format to generate and operate with, by
default <code class="docutils literal notranslate"><span class="pre">DataType.KAIMAL</span></code></p></li>
<li><p><strong>k1_data_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Any]</span></code>, <em>optional</em>) – Wavevector domain of <span class="math notranslate nohighlight">\(k_1\)</span>, by default None</p></li>
<li><p><strong>spectra_file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Path]</span></code>, <em>optional</em>) – If using <code class="docutils literal notranslate"><span class="pre">DataType.CUSTOM</span></code> or <code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code>, this
is used to indicate the data file (a .dat) to read
from. Since it is not used by others, it is by
default None</p></li>
<li><p><strong>zref</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <em>optional</em>) – Reference altitude value, by default 1.0</p></li>
<li><p><strong>spectra_values</strong> (<em>Tensor</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>seed</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – In the case that <code class="docutils literal notranslate"><span class="pre">DataType.CUSTOM</span></code> is indicated, but no spectra_file
    is provided</p></li>
<li><p><strong>ValueError</strong> – In the case that <code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code> data is indicated, but no k1_data_pts
    is provided</p></li>
<li><p><strong>ValueError</strong> – Did not provide DataPoints during initialization for DataType method requiring spectra data.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectraDataGenerator.eval_Kaimal">
<span class="sig-name descname"><span class="pre">eval_Kaimal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/data_generator.html#OnePointSpectraDataGenerator.eval_Kaimal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectraDataGenerator.eval_Kaimal" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the one-point spectra as proposed by <a class="reference external" href="https://apps.dtic.mil/sti/tr/pdf/AD0748543.pdf">Kaimal et al</a> in 1972. Clasically motivated by measurements taken over a flat homogeneous terrain in Kansas, the one-point spectra were proposed as</p>
<div class="math notranslate nohighlight">
\begin{align}
    &amp; \frac{k_1 F_{11}\left(k_1 z\right)}{u_*^2}=J_1(f):=\frac{52.5 f}{(1+33 f)^{5 / 3}} \\
    &amp; \frac{k_1 F_{22}\left(k_1 z\right)}{u_*^2}=J_2(f):=\frac{8.5 f}{(1+9.5 f)^{5 / 3}} \\
    &amp; \frac{k_1 F_{33}\left(k_1 z\right)}{u_*^2}=J_3(f):=\frac{1.05 f}{1+5.3 f^{5 / 3}} \\
    &amp; -\frac{k_1 F_{13}\left(k_1 z\right)}{u_*^2}=J_4(f):=\frac{7 f}{(1+9.6 f)^{12 / 5}},
\end{align}</div><p>with <span class="math notranslate nohighlight">\(F_{12}=F_{23}=0\)</span>. Here, <span class="math notranslate nohighlight">\(f = (2\pi)^{-1} k_1 z\)</span>. This method returns a <span class="math notranslate nohighlight">\(3\times 3\)</span> matrix whose entries are determined by the above equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – First dimension of the wavevector <span class="math notranslate nohighlight">\(k_1\)</span>, this is the domain over which the associated spectra are defined.</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Height above ground, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – The <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix with entries determined by the Kaimal one-point spectra.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectraDataGenerator.eval_VK">
<span class="sig-name descname"><span class="pre">eval_VK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/data_generator.html#OnePointSpectraDataGenerator.eval_VK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectraDataGenerator.eval_VK" title="Link to this definition">#</a></dt>
<dd><p>Evaluation of von Karman spectral tensor given in the form</p>
<div class="math notranslate nohighlight">
\[\Phi_{i j}^{\mathrm{VK}}(\boldsymbol{k})=\frac{E(k)}{4 \pi k^2}\left(\delta_{i j}-\frac{k_i k_j}{k^2}\right)\]</div>
<p>which utilizes the energy spectrum function</p>
<div class="math notranslate nohighlight">
\[E(k)=c_0^2 \varepsilon^{2 / 3} k^{-5 / 3}\left(\frac{k L}{\left(1+(k L)^2\right)^{1 / 2}}\right)^{17 / 3},\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon\)</span> is the viscous dissipation of the turbulent kinetic energy, <span class="math notranslate nohighlight">\(L\)</span> is the length scale parameter and <span class="math notranslate nohighlight">\(c_0^2 \approx 1.7\)</span> is an empirical constant. Here, the physical constants are taken to be :math:<code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">0.59</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – First dimension of the wavevector <span class="math notranslate nohighlight">\(k_1\)</span>, this is a single coordinate of the domain over which the associated spectra are defined.</p></li>
<li><p><strong>z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Height above ground, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – The <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix with entries determined by the von Karman spectra.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectraDataGenerator.generate_Data">
<span class="sig-name descname"><span class="pre">generate_Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DataPoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/data_generator.html#OnePointSpectraDataGenerator.generate_Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectraDataGenerator.generate_Data" title="Link to this definition">#</a></dt>
<dd><p>Generates a single spectral tensor from provided data or from a surrogate model.
The resulting tensor is of shape (number of <span class="math notranslate nohighlight">\(k_1\)</span> points):math:<cite>times 3 times 3</cite>,
ie the result consists of the spectral tensor evaluated across the provided range of
<span class="math notranslate nohighlight">\(k_1\)</span> points. The spectra model is set during object instantiation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DataType.CUSTOM</span></code> type results in replication of the provided spectra data.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>DataPoints</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable[Tuple[torch.tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]]</span></code>) – Observed spectra data points at each of the <span class="math notranslate nohighlight">\(k_1\)</span> coordinates, paired with the associated reference height (typically kept at 1, but may depend on applications).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[torch.Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor]</span></code> – Evaluated spectral tensor on each of the provided grid points depending on the <code class="docutils literal notranslate"><span class="pre">DataType</span></code> selected.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – DataType set such that an iterable set of spectra values and heights is required. This is for any DataType other than <code class="docutils literal notranslate"><span class="pre">CUSTOM</span></code> and <code class="docutils literal notranslate"><span class="pre">AUTO</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[<em>Tensor</em>, <em>Tensor</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectraDataGenerator.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_interp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectra_full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_coords_full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/data_generator.html#OnePointSpectraDataGenerator.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectraDataGenerator.plot" title="Link to this definition">#</a></dt>
<dd><p>Utility for plotting current spectra data over the wavevector domain. Note that if the datatype is chosen to be <code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code>, the interpolation coordinates in the frequency space must be provided again to determine the domain over which to plot filtered spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_interp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[np.ndarray]</span></code>, <em>optional</em>) – Interpolation domain in normal space (not log-space), if used <code class="docutils literal notranslate"><span class="pre">DataType.AUTO</span></code>, by default None</p></li>
<li><p><strong>spectra_full</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[np.ndarray]</span></code>, <em>optional</em>) – Full tensor of spectra data, by default None</p></li>
<li><p><strong>x_coords_full</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[np.ndarray]</span></code>, <em>optional</em>) – Full <span class="math notranslate nohighlight">\(k_1\)</span> log-space coordinates, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Provide interpolation domain (normal space) for filtered plots.</p></li>
<li><p><strong>ValueError</strong> – Provide original spectra and associated domains as a single stack of np.arrays, even if all x coordinates are matching.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="onepointspectra">
<h2>OnePointSpectra<a class="headerlink" href="#onepointspectra" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drdmannturb.</span></span><span class="sig-name descname"><span class="pre">OnePointSpectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_eddy_lifetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datatypes.html#drdmannturb.EddyLifetimeType" title="drdmannturb.enums.EddyLifetimeType"><span class="pre">EddyLifetimeType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_power_spectra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datatypes.html#drdmannturb.PowerSpectraType" title="drdmannturb.enums.PowerSpectraType"><span class="pre">PowerSpectraType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">PowerSpectraType.RDT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataclasses.html#drdmannturb.NNParameters" title="drdmannturb.parameters.NNParameters"><span class="pre">NNParameters</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra" title="Link to this definition">#</a></dt>
<dd><p>One point spectra implementation, including set-up of eddy lifetime function approximation with DRD models, or several classical eddy lifetime functions.</p>
<p>Initialization of the one point spectra class. This requires the type of eddy lifetime function to use, the power spectra type (currently only the von Karman spectra is implemented), the neural network parameters to use if a DRD model is selected, and whether or not to learn <span class="math notranslate nohighlight">\(\nu\)</span> in</p>
<div class="math notranslate nohighlight">
\[\tau(\boldsymbol{k})=\frac{T|\boldsymbol{a}|^{\nu-\frac{2}{3}}}{\left(1+|\boldsymbol{a}|^2\right)^{\nu / 2}}, \quad \boldsymbol{a}=\boldsymbol{a}(\boldsymbol{k}).\]</div>
<p>Here,</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{a}(\boldsymbol{k}):=\operatorname{abs}(\boldsymbol{k})+\mathrm{NN}(\operatorname{abs}(\boldsymbol{k}))\]</div>
<p>if a neural network is used to learn the eddy lifetime function. For a discussion of the details and training, refer to the original DRD paper by Keith et al.</p>
<p>Non-neural network eddy lifetime functions are provided as well, specifically the Mann model. The default power spectra used is due to von Karman.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type_eddy_lifetime</strong> (<a class="reference internal" href="datatypes.html#drdmannturb.EddyLifetimeType" title="drdmannturb.EddyLifetimeType"><code class="xref py py-class docutils literal notranslate"><span class="pre">EddyLifetimeType</span></code></a>, <em>optional</em>) – Type of eddy lifetime function <span class="math notranslate nohighlight">\(\tau\)</span> to use.</p></li>
<li><p><strong>type_power_spectra</strong> (<a class="reference internal" href="datatypes.html#drdmannturb.PowerSpectraType" title="drdmannturb.PowerSpectraType"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerSpectraType</span></code></a>, <em>optional</em>) – Type of power spectra function to use, by default PowerSpectraType.RDT, the only one currently implemented.</p></li>
<li><p><strong>nn_parameters</strong> (<a class="reference internal" href="dataclasses.html#drdmannturb.NNParameters" title="drdmannturb.NNParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">NNParameters</span></code></a>, <em>optional</em>) – Dataclass containing neural network initialization if a neural network is used to approximate the eddy lifetime function, by default None.</p></li>
<li><p><strong>learn_nu</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – Whether or not to learn <span class="math notranslate nohighlight">\(\nu\)</span>, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – “Selected neural network-based eddy lifetime function approximation but did not specify neural network parameters. Pass a constructed NNParameters object.”</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.EddyLifetime">
<span class="sig-name descname"><span class="pre">EddyLifetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.EddyLifetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.EddyLifetime" title="Link to this definition">#</a></dt>
<dd><p>Evaluation of eddy lifetime function <span class="math notranslate nohighlight">\(\tau\)</span> constructed during object initialization. This may be the Mann model or a DRD neural network that learns <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[torch.Tensor]</span></code>, <em>optional</em>) – Wavevector domain on which to evaluate the eddy lifetime function, by default None, which defaults to grids in logspace(-3, 3).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – Evaluation of current eddylifetime function on provided domain.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Did not specify an admissible EddyLifetime model. Refer to the EddyLifetimeType documentation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.InitialGuess_EddyLifetime">
<span class="sig-name descname"><span class="pre">InitialGuess_EddyLifetime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.InitialGuess_EddyLifetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.InitialGuess_EddyLifetime" title="Link to this definition">#</a></dt>
<dd><p>Initial guess at the eddy lifetime function which the DRD model uses in learning the <span class="math notranslate nohighlight">\(\tau\)</span> eddy lifetime function. By default, this is just the <span class="math notranslate nohighlight">\(0\)</span> function, but later functionality may allow this to be dynamically set.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> – Initial guess evaluation, presently, the <span class="math notranslate nohighlight">\(0\)</span> function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.PowerSpectra">
<span class="sig-name descname"><span class="pre">PowerSpectra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.PowerSpectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.PowerSpectra" title="Link to this definition">#</a></dt>
<dd><p>Calls the RDT Power Spectra model with current approximation of the eddy lifetime function and the energy spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – RDT power spectra evaluation.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – In the case that the Power Spectra is not RDT
    and therefore incorrect.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.exp_scales">
<span class="sig-name descname"><span class="pre">exp_scales</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.exp_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.exp_scales" title="Link to this definition">#</a></dt>
<dd><p>Exponentiates the length, time, and spectrum amplitude scales,</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>The first 3 parameters of self.parameters() are exactly</dt><dd><ul class="simple">
<li><p>LengthScale</p></li>
<li><p>TimeScale</p></li>
<li><p>SpectrumAmplitude</p></li>
</ul>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float]</span></code> – Scalar values for each of the length, time, and magnitude scales, in that order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.forward" title="Link to this definition">#</a></dt>
<dd><p>Evaluation of one point spectra</p>
<div class="math notranslate nohighlight">
\[\widetilde{J}_i(f ; \boldsymbol{\theta})=C k_1 \widetilde{F}_{i i}\left(k_1 z ; \boldsymbol{\theta}\right),\]</div>
<p>defined by equations 6 (a-d) in the original DRD paper. Here,</p>
<div class="math notranslate nohighlight">
\[\widetilde{F}_{i j}\left(k_1 ; \boldsymbol{\theta}\right)=\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \Phi_{i j}^{\mathrm{DRD}}(\boldsymbol{k}, \boldsymbol{\theta}) \mathrm{d} k_2 \mathrm{~d} k_3.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k1_input</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Discrete <span class="math notranslate nohighlight">\(k_1\)</span> wavevector domain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – Network output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.get_div">
<span class="sig-name descname"><span class="pre">get_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.get_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.get_div" title="Link to this definition">#</a></dt>
<dd><p>Evaluates the divergence of an evaluated spectral tensor. This is evaluated simply as <span class="math notranslate nohighlight">\(\textbf{k} \cdot \Phi_{\textbf{k}}\)</span> and normalized by the trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Phi</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Discrete evaluated spectral tensor <span class="math notranslate nohighlight">\(\Phi(\textbf{k}, \tau)\)</span>, which may or may not depend on the eddy lifetime function. For instance, if the von Karman model is used, no <span class="math notranslate nohighlight">\(\tau\)</span> dependence is present.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – Divergence of the spectral tensor in the frequency domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.init_mann_approximation">
<span class="sig-name descname"><span class="pre">init_mann_approximation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.init_mann_approximation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.init_mann_approximation" title="Link to this definition">#</a></dt>
<dd><p>Initializes Mann eddy lifetime function approximation by performing a linear regression in log-log space on
a given wave space and the true output of</p>
<div class="math notranslate nohighlight">
\[\frac{x^{-\frac{2}{3}}}{\sqrt{{ }_2 F_1\left(1 / 3,17 / 6 ; 4 / 3 ;-x^{-2}\right)}}\]</div>
<p>This operation is performed once on the CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.quad23">
<span class="sig-name descname"><span class="pre">quad23</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.quad23"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.quad23" title="Link to this definition">#</a></dt>
<dd><p>Computes an approximation of the integral of the discretized function <span class="math notranslate nohighlight">\(f\)</span> in the dimensions defined by <span class="math notranslate nohighlight">\(k_2\)</span> and <span class="math notranslate nohighlight">\(k_3\)</span> using the trapezoidal rule:</p>
<div class="math notranslate nohighlight">
\[\int \int f(k_1 ; \mathbf{\theta}) d k_2 dk_3.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>) – Function evaluation (tensor) to integrate over the frequency domain constructed during initialization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> – Evaluated double integral.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tensor</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drdmannturb.OnePointSpectra.set_scales">
<span class="sig-name descname"><span class="pre">set_scales</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LengthScale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TimeScale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Magnitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/drdmannturb/spectra_fitting/one_point_spectra.html#OnePointSpectra.set_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drdmannturb.OnePointSpectra.set_scales" title="Link to this definition">#</a></dt>
<dd><p>Sets scalar values for values used in non-dimensionalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LengthScale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.float64</span></code>) – Length scale.</p></li>
<li><p><strong>TimeScale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.float64</span></code>) – Time scale.</p></li>
<li><p><strong>Magnitude</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.float64</span></code>) – Spectrum amplitude magnitude.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="datatypes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Types and Eddy Lifetime Functions</p>
      </div>
    </a>
    <a class="right-next"
       href="losses.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Loss Function Evaluation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrationproblem">CalibrationProblem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.calibrate"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.calibrate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.eval"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.eval_grad"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.eval_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.eval_trainable_norm"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.eval_trainable_norm()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.format_input"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.format_input()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.format_output"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.format_output()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.init_device"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.init_device()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.initialize_parameters_with_noise"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.initialize_parameters_with_noise()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.log_dimensional_scales"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.log_dimensional_scales()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.num_trainable_params"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.num_trainable_params()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.parameters"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.parameters</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.plot"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.plot_losses"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.plot_losses()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.CalibrationProblem.save_model"><code class="docutils literal notranslate"><span class="pre">CalibrationProblem.save_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#onepointspectradatagenerator">OnePointSpectraDataGenerator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectraDataGenerator"><code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectraDataGenerator.eval_Kaimal"><code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator.eval_Kaimal()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectraDataGenerator.eval_VK"><code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator.eval_VK()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectraDataGenerator.generate_Data"><code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator.generate_Data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectraDataGenerator.plot"><code class="docutils literal notranslate"><span class="pre">OnePointSpectraDataGenerator.plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#onepointspectra">OnePointSpectra</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.EddyLifetime"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.EddyLifetime()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.InitialGuess_EddyLifetime"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.InitialGuess_EddyLifetime()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.PowerSpectra"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.PowerSpectra()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.exp_scales"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.exp_scales()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.forward"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.get_div"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.get_div()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.init_mann_approximation"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.init_mann_approximation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.quad23"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.quad23()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#drdmannturb.OnePointSpectra.set_scales"><code class="docutils literal notranslate"><span class="pre">OnePointSpectra.set_scales()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/calibration.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright Alexey Izmailov, Matthew Meeker.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>